<div class="margin-y container">
  <div class="row">
    <main class="col-md-10 offset-md-1">
      <%= form_with url: posts_path, method: :get do |f| %>
      <div class="d-flex w-75 mx-auto margin-y">
      	<%= f.text_field :search, placeholder: "投稿タイトル", class: "form-control" %>
        <%= f.submit "検索", class: "btn btn-primary ml-3" %>
      </div>
      <% end %>

      <!--投稿一覧・タイトル検索・タグ検索表示-->
      <div class="d-flex justify-content-between">
        <div>
          <% if params[:search] %>
            <div class="d-flex align-items-center">
              <h2>"<%= @search %>"での検索一覧</h2>
              <!--投稿がなかった場合-->
              <% if @posts == nil %>
                <span class="mx-2">(ヒットする投稿がありません)</span>
              <% else %>
                <span class="mx-2">(<%= @posts.count %>件ヒットしました)</span>
              <% end %>
            </div>
          <% elsif params[:tag] %>
            <div class="d-flex align-items-center">
              <!--params[:tag] == ""の場合tag.nameがエラーとなるため-->
              <% unless params[:tag] == "" %>
                <h2>"<%= @tag.name %>"タグ検索一覧</h2>
              <% else %>
                <h2>投稿一覧</h2>
              <% end %>
              <!--投稿がなかった場合-->
              <% if @posts == nil %>
                <span class="mx-2">(ヒットする投稿がありません)</span>
              <!--params[:tag] == ""の場合-->
              <% elsif params[:tag] == "" %>
                <span></span>
              <% else %>
                <span class="mx-2">(<%= @posts.count %>件ヒットしました)</span>
              <% end %>
            </div>
          <% else %>
            <h2>画像一覧</h2>
          <% end %>
        </div>
        <% if user_signed_in?%>
          <% if current_user.email != "guest@example.com" %>
            <div>
              <%= link_to '画像を投稿する', new_post_path, class: "btn btn-primary px-3 rounded-pill" %>
            </div>
          <% end %>
        <% end %>
      </div>

      <%= link_to '新しい', posts_path(tag: params[:tag], search: params[:search], order: 'new')%>
      <%= link_to '古い', posts_path(tag: params[:tag], search: params[:search], order: 'old')%>
      <%= link_to 'ブックマーク', posts_path(tag: params[:tag], search: params[:search], order: 'bookmarks')%>

      <div class="margin-y">
        <% unless @posts == nil %>
        <%= render "public/posts/post_item", model: @posts, colsize: "3" %>
        <% end %>
      </div>
      <%= paginate @posts, window: 1, left: 1, right: 1 %>
    </main>
  </div>
</div>